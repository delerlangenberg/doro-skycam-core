<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>SkyCam Observatory Â· IT:U Austria</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{--bg:#020617;--panel:#0b1220;--muted:#94a3b8;--ink:#e5e7eb;--line:#1e293b;--accent:#38bdf8}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;background:radial-gradient(circle at top,#0f172a 0,#020617 55%);color:var(--ink)}
.shell{max-width:1100px;margin:auto;padding:28px 16px 36px}
h1{margin:0 0 6px;font-size:22px}
p{margin:0;color:var(--muted)}
.card{border:1px solid var(--line);border-radius:18px;background:rgba(2,6,23,.72);padding:16px 16px 18px;margin:14px 0}
.row{display:flex;flex-wrap:wrap;gap:.6rem;margin:.8rem 0}
.btn{display:inline-flex;align-items:center;justify-content:center;padding:.55rem .9rem;border-radius:999px;border:1px solid var(--accent);color:var(--ink);text-decoration:none;background:rgba(56,189,248,.10)}
.btn.ghost{border-color:var(--line);color:var(--muted);background:transparent}
code{background:rgba(255,255,255,.03);border:1px solid var(--line);padding:.15rem .4rem;border-radius:6px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.kpi{border:1px solid var(--line);border-radius:14px;padding:12px;background:rgba(255,255,255,.02)}
.kpi .label{color:var(--muted);font-size:12px}
.kpi .value{font-size:18px;margin-top:4px}
.small{font-size:12px;color:var(--muted);line-height:1.5}
img{max-width:100%;border-radius:14px;border:1px solid var(--line)}
hr{border:0;border-top:1px solid var(--line);margin:12px 0}
.badge{display:inline-flex;gap:.45rem;align-items:center;border:1px solid var(--line);border-radius:999px;padding:.25rem .6rem;color:var(--muted);font-size:12px;margin:10px 0 0}
.dot{width:8px;height:8px;border-radius:999px;background:#22c55e;box-shadow:0 0 10px rgba(34,197,94,.5)}
</style>
</head>
<body>
<div class="shell">

<h1>ğŸŒŒ SkyCam Observatory</h1>
<p>All-sky camera + meteorological stream (OMEA). Latest image is pushed from the Observatory PC via FTP; meteo via MQTT â†’ live JSON.</p>

<div class="badge"><span class="dot"></span>Live (internal network)</div>

<div class="card">
  <h2 style="margin:0 0 8px;font-size:16px">ğŸ“¸ Latest Sky Image</h2>
  <div class="row">
    <a class="btn" href="/skycam/sky_latest.jpg">ğŸ–¼ Open image</a>
    <a class="btn ghost" href="/skycam/archive/">ğŸ—‚ Daily archive (soon)</a>
    <a class="btn ghost" href="/skycam/mjpeg">ğŸ“¹ Live video (soon)</a>
  </div>
  <img src="/skycam/sky_latest.jpg" alt="Latest sky image">
  <div class="small" style="margin-top:8px">
    Tip: if the image doesnâ€™t refresh in the browser, hard refresh (Ctrl+F5). The file updates every minute.
  </div>
</div>

<div class="card">
  <h2 style="margin:0 0 8px;font-size:16px">ğŸŒ¡ Live Meteo (from MQTT)</h2>
  <div class="grid" id="kpis">
    <div class="kpi"><div class="label">Timestamp</div><div class="value" id="ts">â€”</div></div>
    <div class="kpi"><div class="label">Temperature (Â°C)</div><div class="value" id="t">â€”</div></div>
    <div class="kpi"><div class="label">Humidity (%)</div><div class="value" id="h">â€”</div></div>
    <div class="kpi"><div class="label">Pressure (hPa)</div><div class="value" id="p">â€”</div></div>
    <div class="kpi"><div class="label">Wind speed (m/s)</div><div class="value" id="ws">â€”</div></div>
    <div class="kpi"><div class="label">Wind dir (Â°)</div><div class="value" id="wd">â€”</div></div>
  </div>

  <hr>

  <div class="small">
    <div><strong>JSON:</strong> <a href="/skycam/live.json" style="color:var(--accent);text-decoration:none">/skycam/live.json</a></div>
    <div><strong>MQTT broker:</strong> <code>10.0.0.100:1883</code></div>
    <div><strong>MQTT topic:</strong> <code>skycam/meteo/live</code></div>
  </div>
</div>

<div class="card">
  <h2 style="margin:0 0 8px;font-size:16px">ğŸŒ— Sky Status (next)</h2>
  <p class="small">
    Planned here (NOT on the main page): day/night state, cloud estimate, sky clarity, and â€œbest observing windowâ€.
    Weâ€™ll compute it from: timestamp + sun elevation (Linz) + humidity/pressure/wind + optional brightness/cloud metrics from the image.
  </p>
  <div class="row">
    <a class="btn ghost" href="/skycam/status.json">ğŸŒ— status.json (soon)</a>
    <a class="btn ghost" href="/skycam/charts/">ğŸ“ˆ Charts (soon)</a>
    <a class="btn ghost" href="/skycam/docs.html">ğŸ“˜ Docs</a>
  </div>
</div>

<script>
async function refresh(){
  try{
    const r = await fetch('/skycam/live.json', {cache:'no-store'});
    const j = await r.json();
    const get = (k)=> (j[k]===undefined || j[k]===null) ? 'â€”' : j[k];
    document.getElementById('ts').textContent = get('timestamp');
    document.getElementById('t').textContent  = get('temperature');
    document.getElementById('h').textContent  = get('humidity');
    document.getElementById('p').textContent  = get('pressure');
    document.getElementById('ws').textContent = get('wind_speed');
    document.getElementById('wd').textContent = get('wind_dir');
  }catch(e){}
}
refresh();
setInterval(refresh, 5000);
</script>

</div>
</body>
</html>
